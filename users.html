<!DOCTYPE html>
<html lang="hu" class="h-100">
<head>
    <title>Hazizz!</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
          integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

    <!-- Custom CSS-->
    <link rel="stylesheet" href="css/custom.css">

    <!-- Icon -->
    <link rel="icon" href="assets/icon.png" type="image/png">
</head>
<body>

<table class="table table-striped  table-responsive">
    <thead class="">
    <tr>
        <th scope="col">#</th>
        <th scope="col">Username</th>
        <th scope="col">Date</th>
    </tr>
    </thead>
    <tbody>
    <!-- ko foreach: users -->
    <tr>
        <td scope="row" data-bind="text: id"></td>
        <td data-bind="text: username"></td>
        <td data-bind="text: registrationDate"></td>
    </tr>
    <!-- /ko -->
    </tbody>
</table>

<!-- Optional JavaScript -->
<!-- Font Awesome JS -->
<script defer src="https://use.fontawesome.com/releases/v5.6.3/js/all.js"
        integrity="sha384-EIHISlAOj4zgYieurP0SdoiBYfGJKkgWedPHH4jCzpCXLmzVsw1ouK59MuUtP4a1"
crossorigin="anonymous"></script>
<!-- Knockout JS-->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script>

    function TasksViewModel() {
        var self = this;
        self.URI = 'https://hazizz.duckdns.org:8081';
        self.username = "bela";
        self.password = "bela";
        self.users = ko.observableArray();

        self.ajax = function(uri, method, data) {
            var request = {
                url: uri,
                type: method,
                contentType: "application/json",
                cache: false,
                dataType: 'json',
                data: JSON.stringify(data),
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("Authorization",
                        "Basic " + btoa(self.username + ":" + self.password));
                },
                error: function(jqXHR) {
                    console.log("ajax error " + jqXHR.status);
                }
            };
            return $.ajax(request);
        }

        self.ajax(self.URI, 'GET').done(function(data) {
            for (var i = 0; i < data.users.length; i++) {
                self.users.push({
                    uri: ko.observable(data.users[i].uri),
                    id: ko.observable(data.users[i].id),
                    username: ko.observable(data.users[i].username),
                    registrationDate: ko.observable(data.users[i].registrationDate)
                });
            }
        });

        console.log(self.users()[0])
    }
    ko.applyBindings(new TasksViewModel(), $('#main')[0]);

</script>
</body>
</html>